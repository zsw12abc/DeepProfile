# DeepProfile - 知乎用户画像分析插件

DeepProfile 是一个 Chrome 浏览器插件，利用 AI 技术（OpenAI, Gemini, DeepSeek, Ollama, Qwen）分析知乎用户的近期动态，生成多维度的性格与领域偏好画像，辅助理性交流。

## 🚀 核心功能

*   **多模型支持**：
    *   **云端模型**: OpenAI (GPT-3.5/4), Google Gemini, DeepSeek, 通义千问 (Qwen)。
    *   **本地模型**: 支持通过 Ollama 运行本地 LLM (如 Llama 3, Mistral)。
*   **多维度画像分析**：基于 8 大类 40+ 个细分维度进行深度分析：
    *   🏛️ **政治倾向**: 左翼/右翼、自由/威权、全球化/民族主义等。
    *   💰 **经济观点**: 市场/干预、投机/价值、实体/虚拟等。
    *   👥 **社会观点**: 个人/集体、女权/父权、精英/草根等。
    *   💻 **科技观点**: 开放/封闭、加速主义/保守主义等。
    *   🎨 **文化/环境/娱乐/生活**: 涵盖审美、环保、二次元、职场观等。
*   **智能分析模式**：
    *   ⚡ **极速模式 (Fast Mode)**: 
        *   **特点**: 速度最快，Token 消耗最少。
        *   **原理**: 使用精简版 Prompt，仅做快速总结，温度设为 0.3 以确保结果稳定。
        *   **适用**: 快速查看用户成分概览。
    *   ⚖️ **平衡模式 (Balanced Mode)**: 
        *   **特点**: 默认推荐，兼顾分析质量与响应速度。
        *   **原理**: 使用标准版 Prompt，包含完整的社会学分析视角，温度设为 0.5。
        *   **适用**: 大多数日常分析场景。
    *   🧠 **深度模式 (Deep Mode)**: 
        *   **特点**: 分析最透彻，但耗时较长。
        *   **原理**: 激活思维链 (CoT)，额外指令要求深入分析修辞、隐喻和深层逻辑。
        *   **适用**: 识别“阴阳怪气”、反讽或分析长篇深度内容。
*   **历史记录管理**：自动缓存分析结果，支持在设置页查看、管理和删除历史画像。
*   **隐私安全**：API Key 仅存储在本地浏览器中，不上传任何服务器。
*   **无感嵌入**：在知乎评论区和用户主页的用户链接旁自动添加 **🔍** 分析按钮。

## 🛠️ 安装与开发

### 前置要求
*   Node.js 18+
*   pnpm 或 npm

### 1. 安装依赖
```bash
npm install
# 或者
pnpm install
```

### 2. 运行测试
本项目包含完整的单元测试，覆盖配置管理、数据清洗和 AI 服务接口。
```bash
npm test
```

### 3. 启动开发服务器
```bash
npm run dev
```
此命令会实时编译插件代码到 `build/chrome-mv3-dev` 目录。

### 4. 打包发布
```bash
npm run build
# 或者直接打包成 zip
npx plasmo package
```

### 5. 加载到 Chrome
1.  打开 Chrome 浏览器，访问 `chrome://extensions/`。
2.  开启右上角的 **"开发者模式" (Developer mode)**。
3.  点击 **"加载已解压的扩展程序" (Load unpacked)**。
4.  选择本项目下的 `build/chrome-mv3-dev` 文件夹。

## 📖 使用指南

### 第一步：配置 API Key
1.  插件加载成功后，在 Chrome 扩展栏找到 DeepProfile 图标。
2.  右键点击图标，选择 **"选项" (Options)**。
3.  在设置页中：
    *   选择你喜欢的 AI 提供商（推荐 **DeepSeek** 或 **OpenAI**）。
    *   填入对应的 API Key。
    *   **自定义模型**: 可以手动输入模型名称（如 `gpt-4o`, `deepseek-chat`）。
    *   **分析模式**: 根据需要选择 ⚡极速、⚖️平衡 或 🧠深度模式。
4.  点击 **保存配置**。

### 第二步：分析用户
1.  打开知乎任意回答或文章页面。
2.  浏览评论区，你会发现用户 ID 链接旁边多了一个小的 **🔍** 图标。
3.  点击该图标。
4.  右下角会弹出一个浮窗，显示正在分析中。
5.  几秒钟后，浮窗将展示该用户的画像分析结果。

### 第三步：管理历史记录
1.  进入插件 **"选项" (Options)** 页面。
2.  点击左侧的 **"历史记录"** 菜单。
3.  你可以查看已分析的用户列表，展开查看详细画像，或删除特定记录。

## ⚠️ 常见问题

*   **分析失败/报错？**
    *   检查 API Key 是否正确。
    *   检查网络连接（部分 API 需要科学上网）。
    *   如果是 Ollama，请确保允许跨域请求（设置环境变量 `OLLAMA_ORIGINS="*"`）。
*   **找不到🔍图标？**
    *   尝试刷新页面。
    *   知乎页面结构更新频繁，如果选择器失效，请提交 Issue。

## 🤝 贡献
欢迎提交 Pull Request 或 Issue！

---
*Powered by Plasmo Framework*
