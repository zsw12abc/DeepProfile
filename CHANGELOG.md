# DeepProfile 开发进展与更新日志

## 当前版本: v0.3.0 (Beta)

### ✅ 已达成功能

#### 核心功能
- [x] **多平台架构**: 预留 Reddit 等多平台支持的扩展接口。
- [x] **多模型支持**:
    - 新增 **通义千问 (Qwen)** 和 **Custom (OpenAI 兼容)** 服务商。
    - 支持**动态加载模型列表**，避免手动输入错误。
- [x] **知乎数据抓取**: 
    - 自动解析用户 Hash ID 为 URL Token。
    - **混合数据源**: 并行抓取用户的**原创内容 (回答/文章)** 与 **赞同动态**。
    - 支持抓取数量配置 (10-50条)。
- [x] **上下文感知 (Context-Aware)**:
    - **精准提取**: 自动提取当前页面的问题标题和**知乎官方话题标签**。
    - **智能排序**: 使用**双克隆 (Bigram) 匹配**和**话题标签匹配**算法，精准筛选与当前上下文最相关的用户动态。
    - **动态截断**: 当相关内容足够时，**主动减少**不相关内容的干扰，确保分析焦点。
- [x] **深度画像生成**:
    - **内容为王**: 优先提取并分析**回答/文章正文**，而非简短摘要。
    - **规避风控**: 将“政治倾向”降敏为“**价值取向**”，从“经济”、“文化”、“国际观”等多维度进行中性分析。
    - **矛盾点分析**: 要求 LLM 在总结中解释用户观点中的矛盾之处。
    - **证据引用**: 提供可点击的原文引用链接，支持跳转到具体回答/文章。

#### 用户体验 (UI/UX)
- [x] **无感注入**: 仅在用户昵称右侧显示 "🔍" 图标，自动过滤头像和重复链接。
- [x] **实时反馈**: 
    - 点击即显示用户昵称。
    - 详细的进度提示 (获取信息 -> 抓取动态 -> AI 分析)。
- [x] **结果展示**:
    - **多维价值图谱**: 使用进度条展示不同维度上的价值取向。
    - 折叠式证据栏，保持界面整洁。
- [x] **连接测试**: 在设置页提供“测试连接”功能，并返回**友好的中文错误提示** (如余额不足、Key无效)。

#### 高级设置
- [x] **自定义配置**:
    - **模型下拉选择**: 自动获取并展示可用模型列表。
    - 自定义 API Base URL (支持代理)。
- [x] **分析模式**:
    - **⚡ 极速**: 快速概览。
    - **⚖️ 平衡**: 标准分析。
    - **🧠 深度**: 启用思维链 (CoT)，深度识别反讽、隐喻。
- [x] **开发者调试 (Debug Mode)**:
    - **透明化**: 新增 `Source` 字段，清晰展示“抓取了多少 -> 找到了多少相关 -> 最终分析了多少”。
    - **数据溯源**: 新增 `Breakdown` 字段，展示原创内容 vs 赞同内容的比例。

---

## 版本历史

### v0.3.0 (2024-01-04) - 精准聚焦与体验优化
*   **Major Feature**: **重构上下文感知算法**，使用话题标签进行精准匹配，并采用动态截断策略，彻底解决话题跑偏问题。
*   **Major Feature**: **重构 Prompt**，使用“价值取向”代替“政治倾向”，规避国产模型风控，并要求 AI 解释矛盾点。
*   **Feature**: **新增“连接测试”功能**，提供友好的中文错误提示。
*   **Feature**: **动态加载模型列表**，将模型名称输入框升级为下拉选择框。
*   **Feature**: 新增对**通义千问 (Qwen)** 和**自定义 OpenAI 兼容接口**的支持。
*   **Feature**: 数据源增加**用户点赞动态**，并能在 Debug 面板中展示来源比例。
*   **Fix**: 优先提取并分析回答/文章的**完整正文**，而非简短摘要。
*   **UI**: 设置页面 UI 现代化，采用卡片式布局。

### v0.2.0 (2024-01-03) - 深度分析与上下文感知
*   **Feature**: 新增上下文感知功能，根据当前浏览的问题自动筛选用户相关回答。
*   **Feature**: 新增“分析模式”设置 (极速/平衡/深度)，深度模式支持识别反讽。
*   **Feature**: 画像标签新增置信度概率展示。
*   **Feature**: Debug 模式增强，显示话题分类和抓取策略。
*   **Fix**: 优化注入逻辑，精准定位昵称右侧，排除头像干扰。
*   **Fix**: 修复引用链接为 API 格式的问题，统一为网页链接。

### v0.1.0 (2024-01-02) - MVP 发布
*   **Feature**: 完成基础架构 (Plasmo + React + TypeScript)。
*   **Feature**: 实现知乎 API 抓取与清洗。
*   **Feature**: 对接 OpenAI/Gemini/Ollama 接口。
*   **Feature**: 实现基础 UI 注入与画像展示卡片。
*   **Feature**: 支持 API Key 配置。

---

## 📅 待办计划 (Roadmap)

- [ ] **历史记录**: 本地保存已分析过的用户画像，避免重复消耗 Token。
- [ ] **批量分析**: 在评论区支持一键分析多人。
- [ ] **导出功能**: 支持将画像导出为图片或 Markdown。
- [ ] **更多平台**: 探索支持 Bilibili、微博等其他平台。
